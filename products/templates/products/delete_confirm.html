{% extends 'products/base.html' %}

{% block title %}Удаление товара{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-trash-alt text-danger"></i>
                        Подтверждение удаления товара
                    </h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-warning">
                        <h4 class="alert-heading">
                            <i class="fas fa-exclamation-triangle"></i>
                            Внимание!
                        </h4>
                        <p>Вы собираетесь удалить товар с Hood.de. Это действие нельзя отменить.</p>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h5>Информация о товаре:</h5>
                            <table class="table table-sm">
                                <tr>
                                    <td><strong>ID:</strong></td>
                                    <td>{{ product.id }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Название:</strong></td>
                                    <td>{{ product.title }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Цена:</strong></td>
                                    <td>{{ product.price }} €</td>
                                </tr>
                                <tr>
                                    <td><strong>Категория:</strong></td>
                                    <td>{{ product.hood_category.name }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Hood Item ID:</strong></td>
                                    <td><code>{{ product.hood_item_id }}</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Статус:</strong></td>
                                    <td>
                                        {% if product.is_uploaded_to_hood %}
                                            <span class="badge badge-success">Загружен на Hood.de</span>
                                        {% else %}
                                            <span class="badge badge-secondary">Не загружен</span>
                                        {% endif %}
                                    </td>
                                </tr>
                            </table>
                        </div>
                        
                        <div class="col-md-6">
                            <h5>Описание:</h5>
                            <div class="border p-3 bg-light">
                                {{ product.description|truncatewords:30 }}
                            </div>
                            
                            {% if product.images %}
                            <h5 class="mt-3">Изображения:</h5>
                            <div class="row">
                                {% for image in product.images %}
                                <div class="col-md-4 mb-2">
                                    {% if image.url %}
                                        <img src="{{ image.url }}" class="img-thumbnail" style="max-height: 100px;">
                                    {% elif image.base64 %}
                                        <img src="data:image/jpeg;base64,{{ image.base64 }}" class="img-thumbnail" style="max-height: 100px;">
                                    {% endif %}
                                </div>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <h5>Что произойдет после удаления:</h5>
                        <ul class="list-group">
                            <li class="list-group-item">
                                <i class="fas fa-check text-success"></i>
                                Товар будет удален с Hood.de
                            </li>
                            <li class="list-group-item">
                                <i class="fas fa-check text-success"></i>
                                Статус товара изменится на "Не загружен"
                            </li>
                            <li class="list-group-item">
                                <i class="fas fa-check text-success"></i>
                                Hood Item ID будет очищен
                            </li>
                            <li class="list-group-item">
                                <i class="fas fa-info-circle text-info"></i>
                                Товар останется в локальной базе данных
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="card-footer">
                    <form method="post" class="d-inline">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger btn-lg">
                            <i class="fas fa-trash-alt"></i>
                            Да, удалить товар с Hood.de
                        </button>
                    </form>
                    
                    <a href="{% url 'product_detail' product.id %}" class="btn btn-secondary btn-lg ml-2">
                        <i class="fas fa-times"></i>
                        Отмена
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Подтверждение удаления
document.querySelector('form').addEventListener('submit', function(e) {
    if (!confirm('Вы уверены, что хотите удалить этот товар с Hood.de?')) {
        e.preventDefault();
    }
});
</script>
{% endblock %}
